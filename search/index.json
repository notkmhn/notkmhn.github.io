[{"content":"while writing exploit for vulnerability on particularly weird setup using java needed find way encode class bytecode as text decode it vulnerable machine chain couldn\u0026rsquot any of usual suspect classes do base64 encoding or other options available classpath target instead i\u0026rsquove found that this particular scenario much easier use granted doesn\u0026rsquot work conventional binary decoding works quite well when you have control over both ends line being said would definitely more standard solution general development there are some limitations including lack handling leading zero bytes which didn\u0026rsquot deal since always start magic sequence here\u0026rsquos python implementation sending side note it\u0026rsquos necessary make sure data is interpreted signed integer because will here couple examples first we them by appropriate constructor then invoking","date":"2021-08-21","description":"While writing an exploit for a Java EL injection vulnerability on a particularly weird setup using Java 7, I needed to find a way to encode Java class bytecode...","permalink":"https://rb9.nl/posts/2021-08-21-biginteger-usage-limited-text-binary-encoding/","tags":["java","short"],"title":"Using a BigInteger for (limited) text to binary encoding"},{"content":"recently i\u0026rsquove been wanting run rpi4 is hooked up network over wifi ideally recursive dns resolver that my entire home will be using should not have lot of latency would rather it on connected node since most our personal devices at are also don\u0026rsquot keep running all times conserve energy but if i\u0026rsquom going server could live above can\u0026rsquot one do better just device actually has always still hopefully low power your router this post i\u0026rsquoll go how generally about mucking around soho routers exactly what did achieve goal particular instance tp-link archer c3200 tldr you or similar enough model you\u0026rsquod like own tools services setup we which got sale couple years ago great starting point any other piece software vendor didn\u0026rsquot want simply does allow execute code there some access telnet highly limited presents configuration options available web ui anyway ssh listening accepts connections can login cannot get shell session commands. no biggie usually these limitations by changing their device\u0026rsquos firmware open source alternative ah well none surprising standard fare for pretty much every cheap consider $100+ consumer-grade out knowledge so we\u0026rsquoll find feature allows us goals now we\u0026rsquore determined take route specify looking little bit end scope creeping taking things too far here\u0026rsquos as article constrain ourselves finding persistable command execution doesn\u0026rsquot remote automatically triggerable startup identifying suitable persistent storage option binaries really anything vary quite from another here simple itself without external dependencies additionally make project more approachable myself am amateur hardware hacker best additional unless necessary information gathering first order business copy binary format dissect try plethora idea side put together kind importantly use purposes default keys passwords cough backdoors grubby hands executables reverse engineer vulnerabilities exploit list goes luckily won\u0026rsquot it\u0026rsquos grab latest desired blob inside zip file next manual never touch usual procedure through smooth may obfuscated variety ways being said way matter worst case scenario reversing bootloader reveal its dirty secrets experience had combination basic analysis hypotheses gets job done hints filesystem moving look system realize linux-based they often exectuables them lovely know 32-bit arm useful see kernel modules easily exact version runs fantastic 2.6.36.4 armv7 processor fs understanding what\u0026rsquos sort expect notes later methodology follow figure least following items shown architecture files relate map normally accessible networks interfaces compiled versions custom made developers searching prior art armed depth online resources related search features specific certain urls set indicate two different models very backends there\u0026rsquos few names c7 c5 c2300 relevant prove wiki hacking exec rce bog-standard injection c2 diagnostic page ping util reviewing looks huge chunk work already cut potential exploitation fact same works 0.9.1 0.1 v004b.0 build 160712 time writing entrypoint ole' fashioned nice published vulnerability exploitable exploration straightforward inexplicable reason subsystem form places worth diagnostics line tool ntp client write good reasons mind-boggling clients daemonized vendor-made orchestrator service started \u0026rsquod invoked within logging facilities whatever routers' invoke else fails engineering parts bug hunting persistence doing commands method described even compile drop desire gives only ask indeed something than read-only squashfs worked fine however filesystems change choosing perhaps issue signature checking routine seems given current i\u0026rsquod someone figured then hmm. conundrum leads obvious question though store changes piggyback onto after answer utilizing flash block muck investigate further instead systems mainly aimed modifying mentioned decoding encoding backup needed makes sense contain used invocations sanitization sanitized right turns threat context converting .bin xml back awesome because changed surprise spending having tried decryption avail decided start partially de-compression algorithm initially went webserver contains interesting functions dealing restore respectively briefly process hasn\u0026rsquot compared hardcoded des encryption key shows structure less operation compress proprietary compression encrypt compressed under static compute md5 hash encrypted output bin followed suboperations identified match main significant likely candidate everything supposedly implemented ahead or. maybe when isn\u0026rsquot inherently took break trying looked function hopes hit jackpots aand basically need comparing ghidra implementation emulating angr unicorn spend hunt down wrong modified provided emulation definitely faster approach especially testing independent state handful turn resulting along usage instructions found putting usb drive scripts mounted craft happily provide we\u0026rsquod imho comes varying degrees complexity easy installing toolchain favorite distro\u0026rsquos package repositories writeup cases involve building cross-compilation slightly exotic architectures big endian getting built easier supports ridiculously old kernels come came market foray wanted blackhole pihole luck once friend working statically cross compiling le rust install usable ubuntu debian prepare cargo config pointing linker target toolchain\u0026rsquos gcc last steps bash root directory uses let\u0026rsquos stripped release env variable pass strip flag nukedns prepared script launch plugged into reboot servers interface ing known advertising domain extra","date":"2021-03-12","description":"Recently, I've been wanting to run a PiHole server for ad-blocking in my home network, but I didn't want to set up a machine exclusively for it...","permalink":"https://rb9.nl/posts/2021-03-12-running-software-on-soho-router/","tags":["hardware","networking"],"title":"Running your own services on your SOHO router for the greater good"},{"content":"note this post initially there are challenges series all of which based on same problem varying conditions therefore we\u0026rsquoll go through them increasing order difficulty build solutions incrementally n.b files related problems for these their available common modulus we made rsa encryption scheme tester can you break it previous one is very easy so also try harder setting that we\u0026rsquore given two rsa-encrypted messages \\c_1 c_2\\ encryptions flag \\m\\ such \\c_1\\ public key \\n e_1\\ \\c_2\\ e_2\\ other words have message keys share be precise what m^{e_1} \\mod n\\ \\c_2 m^{e_2} \\e_1 randomly generated primes first challenge each multiplied by 17 second third respectively \\n\\ both large terms operations do multiply ciphertexts get ciphertext \\c_m\\ because textbook $$ \\begin{aligned} c_m n\\\\ c_1 \\cdot c_2 m^{e_1 e_2} \\end{aligned} if raise powers \\x\\ \\y\\ then together c_1^{x} c_2^{y} m^{e_1}^{x} m^{e_2}^{y} \\\\ x} m^{e_2 y} m^{x e_1} m^{y e_1 at point take advantage simply states \\a \\in \\mathbb{z}^{+}\\ greatest divisor \\d\\ \\x \\mathbb{z}\\ $$x d$$ calculate efficiently using coefficients happens negative compute modular inverse respective \\\\mod power absolute value coefficient after calculating three different cases simplest variation \\e_1\\ \\e_2\\ relatively prime meaning yields e_2 m^{1} \\quad \\text{by b√©zout's identity} we\u0026rsquove successfully recovered hence don\u0026rsquot recover itself but instead \\m^3 however know form cbctf{ .. 32 characters representing hex-encoded md5 hash bit length 8-bits per character 256 bits 40 charactes 16 312 when 3rd would vicinity 936 lot less than 4096 means cubic root yielding hardest not only right-padded null bytes until it\u0026rsquos ~8192 few before being encrypted start utilize method \\m_p^{17} where \\m_p\\ padded need retrieve \\m_p^{17}\\ how well things keep mind quite 8192 unpadded must least 482 17th becomes sort knowing follows format as ctf actually \\m^{17} no padding deterministic linear equivalent multiplying since bitstring representation \\xxxxx00000000000000\\ \\xxxxx\\ binary coveted facts stated above unpad coefficient1 \\2^b \\b\\ number needed pad close \\\\approx 7880\\ afterwards previously calculated \\2^{-b} \\2^{-b 17} raising now m_p^{17} 2^{-b 2^{b}^{17} m^{17} 2^{b -b mentioned wait haven\u0026rsquot decided worst case going off from real write program does steps described retrieves candidate checks starts expected use conservative starting \\b 7868\\ within attempts probably term seemed apt.\u0026#160\u0026#x21a9\u0026#xfe0e","date":"2017-11-15","description":"There are 3 challenges in this series, all of which are based on the same problem with varying conditions. Therefore, we‚Äôll go through them in increasing order of difficulty and build solutions incrementally...","permalink":"https://rb9.nl/posts/2017-11-15-codeblue2017-common-modulus/","tags":["cryptography","ctf"],"title":"CODE BLUE CTF 2017 - Common Modulus series"}]